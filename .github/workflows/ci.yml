name: CI

on:
    push:
        branches: [main]
    pull_request:
        branches: [main]

jobs:
    test-backend:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4

            - name: Setup Python
              uses: actions/setup-python@v5
              with:
                  python-version: "3.11"

            - name: Install dependencies
              run: pip install -r requirements.txt

            - name: Run tests
              run: echo "TODO - add tests later"

    build-frontend:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4

            - name: Setup Node
              uses: actions/setup-node@v4
              with:
                  node-version: "20"

            - name: Install & Build
              working-directory: ./frontend
              env:
                  NEXT_PUBLIC_NOCODB_URL: http://localhost:8080
                  NEXT_PUBLIC_NOCODB_TABLE_ID: dummy_table_id
                  NEXT_PUBLIC_NOCODB_TOKEN: dummy_token
              run: |
                  npm install
                  npm run build
